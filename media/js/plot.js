//скрипт выводяший графики на всех страницах кроме страницы игрока
var dContainers=[];var dTag=[];var dFull=[];var dShort=[];var dAdvId=[];function makePlot(h,j,k,l,m){h.html('<u>'+h.text()+'</u>');dContainers.push($('<div></div>'));var n=dContainers.length-1;dTag[n]=j;dFull[n]=l;dShort[n]=m;dAdvId[n]=k;h.children().attr("plotId",n);$(dContainers[dContainers.length-1]).html('<div id="container'+j+'" style="min-width: 400px; height: 400px; margin: 0 auto"></div>').dialog({autoOpen:false,width:'80%',buttons:{"Закрыть":function(){$(this).dialog("close")}}});h.children().one("click",function(){var a=$(this).attr('plotId');dContainers[a].dialog('open');var b=dTag[a];var c=[];var d=localStorageDB.loadValue(dTag[a],dAdvId[a]);var e=0;for(var i=0;i<d.length;i++){var f=d[i].d.split(" ")[0].split("/");if(f.length<3)console.error("Ошибка чтения даты из базы "+dTag[a]+dAdvId[a]+" i="+i+" d="+d[i].d);c.push([Date.UTC(f[0],f[1]*1-1,f[2]),d[i].v]);if(e>d[i].v)e=d[i].v}var g=new Highcharts.Chart({chart:{renderTo:'container'+b,type:'spline'},title:{text:dFull[a]},subtitle:{text:'данные загружены из локального хранилища'},xAxis:{type:'datetime',dateTimeLabelFormats:{month:'%e. %b',year:'%b'}},yAxis:{title:{text:dShort[a]},min:e},tooltip:{formatter:function(){return'<b>'+this.series.name+'</b><br/>'+Highcharts.dateFormat('%e. %b',this.x)+':'+dShort[a]+' '+this.y+''}},series:[{name:dShort[a],data:c}]});return false})}
