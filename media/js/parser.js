var parser=(function(){function parseFinance(){$.ajax({url:"http://www.hockeyarena.net/ru/index.php?p=manager_finance_report.php",success:function(b){function Con(a){while(a.indexOf(" ")>0)a=a.replace(" ","");return a|0}var c=Con($(b).find("table tbody span[style]").eq(0).text());var d=$(b).find("td[align=right]");var e=[];for(var i=0;i<12;i++){e.push([])}var f=1;var g=f;for(g=f;g<f+4;g++)e[0][g-f]=Con(d.eq(g).text().trim());f+=5;for(g=f;g<f+4;g++)e[1][g-f]=Con(d.eq(g).text().trim());f+=5;for(g=f;g<f+4;g++)e[2][g-f]=Con(d.eq(g).text().trim());f+=5;for(g=f;g<f+4;g++)e[3][g-f]=Con(d.eq(g).text().trim());f+=5;for(g=f;g<f+4;g++)e[4][g-f]=Con(d.eq(g).text().trim());f+=5;for(g=f;g<f+4;g++)e[5][g-f]=Con(d.eq(g).text().trim());f=31;for(g=f;g<f+4;g++)e[6][g-f]=Con(d.eq(g).text().trim());f+=5;for(g=f;g<f+4;g++)e[7][g-f]=Con(d.eq(g).text().trim());f+=5;for(g=f;g<f+4;g++)e[8][g-f]=Con(d.eq(g).text().trim());f+=5;for(g=f;g<f+4;g++)e[9][g-f]=Con(d.eq(g).text().trim());f+=5;for(g=f;g<f+4;g++)e[10][g-f]=Con(d.eq(g).text().trim());f=56;for(g=f;g<f+4;g++)e[11][g-f]=Con(d.eq(g).text().trim());var h=[];var j=[];var k=[];var l=[];for(var i=0;i<12;i++){h[i]=i;j[i]=i;k[i]=i;l[i]=i}var m=[];var n=[];var o=[];var p=[];for(var i=0;i<12;i++){m.push(e[i][3]);n.push(e[i][2]);o.push(e[i][1]);p.push(e[i][0])}localStorageDB.saveAllValues("FinancesSeasonally",h,m);localStorageDB.saveAllValues("FinancesLastWeek",j,n);localStorageDB.saveAllValues("FinancesCurrentWeek",k,o);localStorageDB.saveAllValues("FinancesToday",l,p)}})};function parseTraining(){$.ajax({url:"http://www.hockeyarena.net/ru/index.php?p=manager_training_form1.php",success:function(a){var b=$(a).find("table tbody tr");notice("Найдено "+(b.length-4)+" игроков");if(b.length<22+4){error_notice("Ошибка, найдено меньше 22-х игроков");return 0}var c={"Вратарь":"1","Пас":"2","Защита":"3","Скорость":"4","Самообладание":"5","Сила":"6","Бросок":"7","Нападение":"8"};var d={"C":"1","LW":"2","RW":"3","RD":"4","LD":"5","G1":"6","G2":"7","запас":"8"};var e=[],eneArray=[],formArray=[],traArray=[],scheduleArray=[],posArray=[];for(var i=0;i<b.length;i++){if($(b[i]).attr("class")!="caption")if($(b[i]).attr("class")!="thead"){var f=$(b[i]).find("td");var g=getUrlVars($(f[0]).find("a")[0].href)["id"].replace('#','');e.push(g);var h=$(f[10]).text();eneArray.push(h);var j=$(f[11]).text();formArray.push(j);var k=$(f[13]).text();traArray.push(k);var l=$(f[14].innerHTML).find("option[selected]").text();scheduleArray.push(c[l]);if(f[15]!=undefined)var m=f[15].innerHTML;else var m="запас";posArray.push(d[m])}}localStorageDB.saveAllValues("Training",e,traArray);localStorageDB.saveAllValues("Energy",e,eneArray);localStorageDB.saveAllValues("Form",e,formArray);localStorageDB.saveAllValues("Schedule",e,scheduleArray);localStorageDB.saveAllValues("Position",e,posArray)}})};function parsePlayers(){$.ajax({url:"http://www.hockeyarena.net/ru/index.php?p=manager_team_players.php",success:function(a){var b=$(a).find("table tbody tr[class]");notice("Найдено "+(b.length-2)+" игроков");if(b.length<24){error_notice("Ошибка, найдено меньше 22-х игроков");return 0}var c=[],perfArray=[],potArray=[],ExperienceArray=[],aiArray=[],goaArray=[],defArray=[],attArray=[],shoArray=[],pasArray=[],speArray=[],strArray=[],scArray=[];for(var i=0;i<b.length;i++){if($(b[i]).attr("class")!="caption")if($(b[i]).attr("class")!="thead"){var d=$(b[i]).find("td");var e=getUrlVars($(d[0]).find("a")[0].href)["player_id"].replace('#','');c.push(e);var f=$.trim($(d[2]).text());perfArray.push(f);var g=$.trim($(d[3]).text());potArray.push(g);var h=$.trim($(d[4]).text());goaArray.push(h);var j=$.trim($(d[5]).text());defArray.push(j);var k=$.trim($(d[6]).text());attArray.push(k);var l=$.trim($(d[7]).text());shoArray.push(l);var m=$.trim($(d[8]).text());pasArray.push(m);var n=$.trim($(d[9]).text());speArray.push(n);var o=$.trim($(d[10]).text());strArray.push(o);var p=$.trim($(d[11]).text());scArray.push(p);var q=$(d[13]).text();ExperienceArray.push(q);var r=$(d[14]).text();aiArray.push(r)}}localStorageDB.saveAllValues("Performance",c,perfArray);localStorageDB.saveAllValues("Potencial",c,potArray);localStorageDB.saveAllValues("Experience",c,ExperienceArray);localStorageDB.saveAllValues("AbilityIndex",c,aiArray);localStorageDB.saveAllValues("Goalie",c,goaArray);localStorageDB.saveAllValues("Speed",c,speArray);localStorageDB.saveAllValues("Defense",c,defArray);localStorageDB.saveAllValues("Strength",c,strArray);localStorageDB.saveAllValues("Offense",c,attArray);localStorageDB.saveAllValues("SelfControl",c,scArray);localStorageDB.saveAllValues("Shooting",c,shoArray);localStorageDB.saveAllValues("Passing",c,pasArray)}})};return{parseFinance:parseFinance,parseTraining:parseTraining,parsePlayers:parsePlayers}})();